<!-- Search Debug Info -->
<div style="display: none;" id="searchDebug">
    Pages: {{ site.pages.size }}<br>
    Posts: {{ site.posts.size }}<br>
    Collections: {% for collection in site.collections %}{{ collection.label }} ({{ collection.docs.size }}), {% endfor %}
</div>

<script type="application/json" id="searchData">
[
    {% for page in site.pages %}
    {% unless page.exclude_from_search or page.url contains '.xml' or page.url contains '.json' or page.url contains '.css' or page.url contains '.js' %}
    {
        "title": "{{ page.title | default: page.name | replace: '"', '&quot;' }}",
        "url": "{{ page.url | relative_url }}",
        "content": "{{ page.content | strip_html | normalize_whitespace | replace: '"', '&quot;' }}",
        "excerpt": "{{ page.excerpt | default: page.content | strip_html | normalize_whitespace | replace: '"', '&quot;' | truncate: 150 }}"
    }{% unless forloop.last %},{% endunless %}
    {% endunless %}
    {% endfor %}
    
    {% if site.posts.size > 0 %},{% endif %}
    
    {% for post in site.posts %}
    {
        "title": "{{ post.title | replace: '"', '&quot;' }}",
        "url": "{{ post.url | relative_url }}",
        "content": "{{ post.content | strip_html | normalize_whitespace | replace: '"', '&quot;' }}",
        "excerpt": "{{ post.excerpt | default: post.content | strip_html | normalize_whitespace | replace: '"', '&quot;' | truncate: 150 }}",
        "tags": "{{ post.tags | join: ', ' | replace: '"', '&quot;' }}",
        "categories": "{{ post.categories | join: ', ' | replace: '"', '&quot;' }}"
    }{% unless forloop.last %},{% endunless %}
    {% endfor %}
]
</script>

<!-- Debug information (visible in page source) -->
<!-- 
Pages: {{ site.pages | size }}
Posts: {{ site.posts | size }}
-->
